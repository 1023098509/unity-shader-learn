# 矩阵

## 用矩阵表示矢量

### 行矩阵

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\begin{bmatrix}&space;1&space;&&space;1&space;&&space;1&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\begin{bmatrix}&space;1&space;&&space;1&space;&&space;1&space;\end{bmatrix}" title="\begin{bmatrix} 1 & 1 & 1 \end{bmatrix}" /></a>

### 列矩阵

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\begin{bmatrix}&space;1&space;\\&space;1&space;\\&space;1&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\begin{bmatrix}&space;1&space;\\&space;1&space;\\&space;1&space;\end{bmatrix}" title="\begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix}" /></a>

## 矩阵运算

### 1.矩阵和标量的乘法

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;kM=Mk=\begin{bmatrix}&space;km_{11}&space;&&space;km_{12}&space;&&space;km_{13}&space;\\&space;km_{21}&space;&&space;km_{22}&space;&&space;km_{23}&space;\\&space;km_{31}&space;&&space;km_{32}&space;&&space;km_{33}&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;kM=Mk=\begin{bmatrix}&space;km_{11}&space;&&space;km_{12}&space;&&space;km_{13}&space;\\&space;km_{21}&space;&&space;km_{22}&space;&&space;km_{23}&space;\\&space;km_{31}&space;&&space;km_{32}&space;&&space;km_{33}&space;\end{bmatrix}" title="kM=Mk=\begin{bmatrix} km_{11} & km_{12} & km_{13} \\ km_{21} & km_{22} & km_{23} \\ km_{31} & km_{32} & km_{33} \end{bmatrix}" /></a>

### 2.矩阵和矩阵的乘法

元素ij等于矩阵A中行i的矢量和矩阵B中列j的矢量进行点积。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;c_{23}=(a_{21},a_{22})\cdot&space;(b_{13},b_{23})=a_{21}b_{13}&plus;a_{22}b_{23}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;c_{23}=(a_{21},a_{22})\cdot&space;(b_{13},b_{23})=a_{21}b_{13}&plus;a_{22}b_{23}" title="c_{23}=(a_{21},a_{22})\cdot (b_{13},b_{23})=a_{21}b_{13}+a_{22}b_{23}" /></a>

![-](https://github.com/1023098509/unity-shader-learn/blob/master/image/4_2_1.png?raw=true "矩阵和矩阵的乘法")

#### 性质一

矩阵乘法不满足交换律。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;AB&space;\neq&space;BA" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;AB&space;\neq&space;BA" title="AB \neq BA" /></a>

#### 性质二

矩阵乘法满足结合律。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;(AB)C&space;=&space;A(BC)" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;(AB)C&space;=&space;A(BC)" title="(AB)C = A(BC)" /></a>

## 特殊的矩阵

### 1.方块矩阵

行数等与列数是方块矩阵。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\begin{bmatrix}&space;1&space;&&space;1&space;&&space;1\\&space;1&space;&&space;1&space;&&space;1\\&space;1&space;&&space;1&space;&&space;1&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\begin{bmatrix}&space;1&space;&&space;1&space;&&space;1\\&space;1&space;&&space;1&space;&&space;1\\&space;1&space;&&space;1&space;&&space;1&space;\end{bmatrix}" title="\begin{bmatrix} 1 & 1 & 1\\ 1 & 1 & 1\\ 1 & 1 & 1 \end{bmatrix}" /></a>

### 2.对角矩阵

ij相等的元素叫对角元素，除了对角元素外都是0的**方块矩阵**，叫做对角矩阵。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\begin{bmatrix}&space;1&space;&&space;0&space;&&space;0\\&space;0&space;&&space;2&space;&&space;0\\&space;0&space;&&space;0&space;&&space;3&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\begin{bmatrix}&space;1&space;&&space;0&space;&&space;0\\&space;0&space;&&space;2&space;&&space;0\\&space;0&space;&&space;0&space;&&space;3&space;\end{bmatrix}" title="\begin{bmatrix} 1 & 0 & 0\\ 0 & 2 & 0\\ 0 & 0 & 3 \end{bmatrix}" /></a>

### 3.单位矩阵

对角元素都是1的**对角矩阵**叫做单位矩阵，用In表示。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;I_{3}=\begin{bmatrix}&space;1&space;&&space;0&space;&&space;0\\&space;0&space;&&space;1&space;&&space;0\\&space;0&space;&&space;0&space;&&space;1&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;I_{3}=\begin{bmatrix}&space;1&space;&&space;0&space;&&space;0\\&space;0&space;&&space;1&space;&&space;0\\&space;0&space;&&space;0&space;&&space;1&space;\end{bmatrix}" title="I_{3}=\begin{bmatrix} 1 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & 1 \end{bmatrix}" /></a>

任何矩阵和它相乘还是原来的矩阵

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;IM=MI=M" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;IM=MI=M" title="IM=MI=M" /></a>

### 4.转置矩阵

转置矩阵实际是对原矩阵的一种运算，即转置运算。给定一个r x c的矩阵M，它的转置可表示成Mt，这是一个c x r 的矩阵。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;M_{ij}^{T}=M_{ji}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;M_{ij}^{T}=M_{ji}" title="M_{ij}^{T}=M_{ji}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\begin{bmatrix}&space;x&space;&&space;y&space;&&space;z&space;\end{bmatrix}^{T}=&space;\begin{bmatrix}&space;x&space;\\&space;y&space;\\&space;z&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\begin{bmatrix}&space;x&space;&&space;y&space;&&space;z&space;\end{bmatrix}^{T}=&space;\begin{bmatrix}&space;x&space;\\&space;y&space;\\&space;z&space;\end{bmatrix}" title="\begin{bmatrix} x & y & z \end{bmatrix}^{T}= \begin{bmatrix} x \\ y \\ z \end{bmatrix}" /></a>

#### 性质一

转置二次等于原矩阵。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\left&space;(&space;M^{T}&space;\right&space;)^{T}=M" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\left&space;(&space;M^{T}&space;\right&space;)^{T}=M" title="\left ( M^{T} \right )^{T}=M" /></a>

#### 性质二

矩阵串接的转置，等于反向串接各个矩阵的转置。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;(AB)^{T}&space;=&space;B^{T}A^{T}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;(AB)^{T}&space;=&space;B^{T}A^{T}" title="(AB)^{T} = B^{T}A^{T}" /></a>

### 5.逆矩阵

给定一个**方阵M**，它的逆矩阵用<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;M^{-1}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;M^{-1}" title="M^{-1}" /></a>表示。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;MM^{-1}=M^{-1}M=I" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;MM^{-1}=M^{-1}M=I" title="MM^{-1}=M^{-1}M=I" /></a>

不是每个矩阵都有逆矩阵，比如零矩阵就没有。通过判断矩阵的行列式不为0来判断它是逆矩阵。

#### 性质一

逆矩阵的逆矩阵等于它本身。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;(M^{-1})^{-1}=M" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;(M^{-1})^{-1}=M" title="(M^{-1})^{-1}=M" /></a>

#### 性质二

单位矩阵的逆矩阵是它本身。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;I^{-1}=I" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;I^{-1}=I" title="I^{-1}=I" /></a>

#### 性质三

矩阵串接相乘后的逆矩阵等于反向串接各个矩阵的逆矩阵。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;(AB)^{-1}=B^{-1}A^{-1}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;(AB)^{-1}=B^{-1}A^{-1}" title="(AB)^{-1}=B^{-1}A^{-1}" /></a>

#### 应用

可以通过逆矩阵得到上次变换。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;M^{-1}(Mv)=(M^{-1}M)v=v" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;M^{-1}(Mv)=(M^{-1}M)v=v" title="M^{-1}(Mv)=(M^{-1}M)v=v" /></a>

## 正交矩阵

正交是矩阵的一种属性，如果一个方阵M和它的的转置矩阵的乘积是单位矩阵的话，我们就说这个矩阵是正交的。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;MM^{T}=M^{T}M=I" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;MM^{T}=M^{T}M=I" title="MM^{T}=M^{T}M=I" /></a>

因此矩阵是正交的话，那么它的转置矩阵等于逆矩阵。

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;M^{T}=M^{-1}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;M^{T}=M^{-1}" title="M^{T}=M^{-1}" /></a>

### 判断正交

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\dpi{150}&space;\\MM^{T}=\begin{bmatrix}&space;-&space;&&space;c_{1}&space;&&space;-&space;\\&space;-&space;&&space;c_{2}&space;&&space;-&space;\\&space;-&space;&&space;c_{3}&space;&&space;-&space;\end{bmatrix}\begin{bmatrix}&space;|&space;&&space;|&space;&&space;|&space;\\&space;c_{1}&space;&&space;c_{2}&space;&&space;c_{3}&space;\\&space;|&space;&&space;|&space;&&space;|&space;\end{bmatrix}\\&space;=&space;\begin{bmatrix}&space;c_{1}c_{1}&space;&&space;c_{1}c_{2}&space;&&space;c_{1}c_{3}&space;\\&space;c_{2}c_{1}&space;&&space;c_{2}c_{2}&space;&&space;c_{2}c_{3}&space;\\&space;c_{3}c_{1}&space;&&space;c_{3}c_{2}&space;&&space;c_{3}c_{3}&space;\end{bmatrix}\\&space;=&space;\begin{bmatrix}&space;1&space;&&space;0&space;&&space;0&space;\\&space;0&space;&&space;1&space;&&space;0&space;\\&space;0&space;&&space;0&space;&&space;1&space;\end{bmatrix}\\&space;=I" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\dpi{150}&space;\\MM^{T}=\begin{bmatrix}&space;-&space;&&space;c_{1}&space;&&space;-&space;\\&space;-&space;&&space;c_{2}&space;&&space;-&space;\\&space;-&space;&&space;c_{3}&space;&&space;-&space;\end{bmatrix}\begin{bmatrix}&space;|&space;&&space;|&space;&&space;|&space;\\&space;c_{1}&space;&&space;c_{2}&space;&&space;c_{3}&space;\\&space;|&space;&&space;|&space;&&space;|&space;\end{bmatrix}\\&space;=&space;\begin{bmatrix}&space;c_{1}c_{1}&space;&&space;c_{1}c_{2}&space;&&space;c_{1}c_{3}&space;\\&space;c_{2}c_{1}&space;&&space;c_{2}c_{2}&space;&&space;c_{2}c_{3}&space;\\&space;c_{3}c_{1}&space;&&space;c_{3}c_{2}&space;&&space;c_{3}c_{3}&space;\end{bmatrix}\\&space;=&space;\begin{bmatrix}&space;1&space;&&space;0&space;&&space;0&space;\\&space;0&space;&&space;1&space;&&space;0&space;\\&space;0&space;&&space;0&space;&&space;1&space;\end{bmatrix}\\&space;=I" title="\\MM^{T}=\begin{bmatrix} - & c_{1} & - \\ - & c_{2} & - \\ - & c_{3} & - \end{bmatrix}\begin{bmatrix} | & | & | \\ c_{1} & c_{2} & c_{3} \\ | & | & | \end{bmatrix}\\ = \begin{bmatrix} c_{1}c_{1} & c_{1}c_{2} & c_{1}c_{3} \\ c_{2}c_{1} & c_{2}c_{2} & c_{2}c_{3} \\ c_{3}c_{1} & c_{3}c_{2} & c_{3}c_{3} \end{bmatrix}\\ = \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix}\\ =I" /></a>

因此等到以下等式：

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\dpi{150}&space;\\&space;c_{1}c_{1}&space;=&space;1&space;,&space;c_{1}c_{2}&space;=&space;0&space;,&space;c_{1}c_{3}&space;=&space;0&space;\\&space;c_{2}c_{1}&space;=&space;0&space;,&space;c_{2}c_{2}&space;=&space;1&space;,&space;c_{2}c_{3}&space;=&space;0&space;\\&space;c_{3}c_{1}&space;=&space;0&space;,&space;c_{3}c_{2}&space;=&space;0&space;,&space;c_{3}c_{3}&space;=&space;1" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\dpi{150}&space;\\&space;c_{1}c_{1}&space;=&space;1&space;,&space;c_{1}c_{2}&space;=&space;0&space;,&space;c_{1}c_{3}&space;=&space;0&space;\\&space;c_{2}c_{1}&space;=&space;0&space;,&space;c_{2}c_{2}&space;=&space;1&space;,&space;c_{2}c_{3}&space;=&space;0&space;\\&space;c_{3}c_{1}&space;=&space;0&space;,&space;c_{3}c_{2}&space;=&space;0&space;,&space;c_{3}c_{3}&space;=&space;1" title="\\ c_{1}c_{1} = 1 , c_{1}c_{2} = 0 , c_{1}c_{3} = 0 \\ c_{2}c_{1} = 0 , c_{2}c_{2} = 1 , c_{2}c_{3} = 0 \\ c_{3}c_{1} = 0 , c_{3}c_{2} = 0 , c_{3}c_{3} = 1" /></a>

得到以下结论：

* 矩阵的每一行，即<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\dpi{110}&space;c_{1},c_{2},c_{3}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\dpi{110}&space;c_{1},c_{2},c_{3}" title="c_{1},c_{2},c_{3}" /></a>是单位矢量，因为这样他们与自己的点积是1。

* 矩阵的每一行，即<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\dpi{110}&space;c_{1},c_{2},c_{3}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\dpi{110}&space;c_{1},c_{2},c_{3}" title="c_{1},c_{2},c_{3}" /></a>之间互相垂直，因为这样他们之间的点积是0。

* 上述两条结论对每一列同样适用，因为是<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\dpi{110}&space;M" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\dpi{110}&space;M" title="M" /></a>正交矩阵，<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\dpi{110}&space;M^{T}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\dpi{110}&space;M^{T}" title="M^{T}" /></a></a>也是正交矩阵。

## Unity中使用矢量和矩阵相乘

常规做法是把矢量右乘，即把矢量转成列矩阵：

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;CBAv=(C(B(Av)))" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;CBAv=(C(B(Av)))" title="CBAv=(C(B(Av)))" /></a>

上面方程，等同与下面行矩阵运算：

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;vA^{T}B^{T}C^{T}=\left&space;(\left&space;(\left&space;(vA&space;^{T}&space;\right&space;)B^{T}&space;\right&space;)C^{T}&space;\right&space;)" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;vA^{T}B^{T}C^{T}=\left&space;(\left&space;(\left&space;(vA&space;^{T}&space;\right&space;)B^{T}&space;\right&space;)C^{T}&space;\right&space;)" title="vA^{T}B^{T}C^{T}=\left (\left (\left (vA ^{T} \right )B^{T} \right )C^{T} \right )" /></a>
