# 矩阵

## 用矩阵表示矢量

### 行矩阵

$\begin{bmatrix} 1 & 1 & 1 \end{bmatrix}$

### 列矩阵

$\begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix}$

## 矩阵运算

### 1.矩阵和标量的乘法

$kM=Mk=\begin{bmatrix} km_{11} & km_{12} & km_{13} \\ km_{21} & km_{22} & km_{23} \\ km_{31} & km_{32} & km_{33} \end{bmatrix}$

### 2.矩阵和矩阵的乘法

元素ij等于矩阵A中行i的矢量和矩阵B中列j的矢量进行点积。

$c_{23}=(a_{21},a_{22})\cdot (b_{13},b_{23})=a_{21}b_{13}+a_{22}b_{23}$

![-](https://github.com/1023098509/unity-shader-learn/blob/master/image/4_2_1.png?raw=true "矩阵和矩阵的乘法")

#### 性质一

矩阵乘法不满足交换律。

$AB \neq BA$

#### 性质二

矩阵乘法满足结合律。

$(AB)C = A(BC)$

## 特殊的矩阵

### 1.方块矩阵

行数等与列数是方块矩阵。

$\begin{bmatrix} 1 & 1 & 1\\ 1 & 1 & 1\\ 1 & 1 & 1 \end{bmatrix}$

### 2.对角矩阵

$ij$相等的元素叫对角元素，除了对角元素外都是0的**方块矩阵**，叫做对角矩阵。

$\begin{bmatrix} 1 & 0 & 0\\ 0 & 2 & 0\\ 0 & 0 & 3 \end{bmatrix}$

### 3.单位矩阵

对角元素都是1的**对角矩阵**叫做单位矩阵，用In表示。

$I_{3}=\begin{bmatrix} 1 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & 1 \end{bmatrix}$

任何矩阵和它相乘还是原来的矩阵

$IM=MI=M$

### 4.转置矩阵

转置矩阵实际是对原矩阵的一种运算，即转置运算。给定一个 $r\times c$ 的矩阵$M$，它的转置可表示成$M_{T}$，这是一个 $c\times r$ 的矩阵。

$M_{ij}^{T}=M_{ji}$

$\begin{bmatrix} x & y & z \end{bmatrix}^{T}= \begin{bmatrix} x \\ y \\ z \end{bmatrix}$

#### 性质一

转置二次等于原矩阵。

$\left ( M^{T} \right )^{T}=M$

#### 性质二

矩阵串接的转置，等于反向串接各个矩阵的转置。

$(AB)^{T} = B^{T}A^{T}$

### 5.逆矩阵

给定一个**方阵**$M$，它的逆矩阵用$M^{-1}$表示。

$MM^{-1}=M^{-1}M=I$

不是每个矩阵都有逆矩阵，比如零矩阵就没有。通过判断矩阵的行列式不为0来判断它是逆矩阵。

#### 性质一

逆矩阵的逆矩阵等于它本身。

$(M^{-1})^{-1}=M$

#### 性质二

单位矩阵的逆矩阵是它本身。

$I^{-1}=I$

#### 性质三

矩阵串接相乘后的逆矩阵等于反向串接各个矩阵的逆矩阵。

$(AB)^{-1}=B^{-1}A^{-1}$

#### 应用

可以通过逆矩阵得到上次变换。

$M^{-1}(Mv)=(M^{-1}M)v=v$

### 5.正交矩阵

正交是矩阵的一种属性，如果一个方阵M和它的的转置矩阵的乘积是单位矩阵的话，我们就说这个矩阵是正交的。

$MM^{T}=M^{T}M=I$

因此矩阵是正交的话，那么它的转置矩阵等于逆矩阵。

$M^{T}=M^{-1}$

#### 判断正交

$$
\begin{aligned}
MM^{T}
& = \begin{bmatrix} - & c_{1} & - \\ - & c_{2} & - \\ - & c_{3} & -  \end{bmatrix} \begin{bmatrix}  | & | & | \\   c_{1} & c_{2} & c_{3} \\    | & | & | \end{bmatrix} \\
& = \begin{bmatrix} c_{1}c_{1} & c_{1}c_{2} & c_{1}c_{3} \\ c_{2}c_{1} & c_{2}c_{2} & c_{2}c_{3} \\ c_{3}c_{1} & c_{3}c_{2} & c_{3}c_{3} \end{bmatrix} \\
& = \begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{bmatrix} \\
& = I
\end{aligned}
$$

因此等到以下等式：

$$\begin{aligned}c_{1}c_{1} = 1 , c_{1}c_{2} = 0 , c_{1}c_{3} = 0 \\ c_{2}c_{1} = 0 , c_{2}c_{2} = 1 , c_{2}c_{3} = 0 \\ c_{3}c_{1} = 0 , c_{3}c_{2} = 0 , c_{3}c_{3} = 1\end{aligned}$$


得到以下结论：

* 矩阵的每一行，即$c_{1},c_{2},c_{3}$是单位矢量，因为这样他们与自己的点积是1。

* 矩阵的每一行，即$c_{1},c_{2},c_{3}$之间互相垂直，因为这样他们之间的点积是0。

* 上述两条结论对每一列同样适用，因为是$M$正交矩阵，$M^{T}$也是正交矩阵。

## Unity中使用矢量和矩阵相乘

常规做法是把矢量右乘，即把矢量转成列矩阵：

$CBAv=(C(B(Av)))$

上面方程，等同与下面行矩阵运算：

$vA^{T}B^{T}C^{T}=\left (\left (\left (vA ^{T} \right )B^{T} \right )C^{T} \right )$